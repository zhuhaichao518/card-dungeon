<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>⚔️ Card Dungeon</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <!-- ───── 头部 ───── -->
  <header id="header">
    <a href="index.html" class="header-back">◀ 菜单</a>
    <h1>⚔️ CARD DUNGEON</h1>
    <div class="hp-bar-container">
      <label>HP</label>
      <div class="hp-bar">
        <div class="hp-bar-fill" id="hp-bar-fill" style="width:62.5%"></div>
      </div>
      <span class="hp-text" id="hp-text">50 / 80</span>
    </div>
    <span id="floor-label">第 1 层</span>
    <button id="btn-pause" class="btn-icon" title="暂停 (Esc)">⏸</button>
  </header>

  <!-- ───── 主体 ───── -->
  <div id="game-container">

    <!-- ══ 探索界面 ══ -->
    <div id="explore-screen">
      <div id="map-area">
        <!-- Canvas 地图 -->
        <canvas id="map-canvas"></canvas>
      </div>

      <aside id="side-panel">
        <div class="panel-section">
          <h3>📦 背包</h3>
          <div class="inventory-item">
            <span style="color:#ffd700">⚷</span> 黄钥匙
            <span class="key-count" id="key-yellow-count">0</span>
          </div>
          <div class="inventory-item">
            <span style="color:#4fc3f7">⚷</span> 蓝钥匙
            <span class="key-count" id="key-blue-count">0</span>
          </div>
          <div class="inventory-item">
            <span style="color:#ef5350">⚷</span> 红钥匙
            <span class="key-count" id="key-red-count">0</span>
          </div>
        </div>

        <div class="panel-section">
          <h3>📜 日志</h3>
          <div id="message-log"></div>
        </div>

        <div class="panel-section">
          <h3>🎮 操作</h3>
          <div class="tips">
            <div>WASD / 方向键 移动</div>
            <div>点击相邻格子 移动</div>
            <div>Esc / ⏸ 暂停</div>
          </div>
        </div>
      </aside>
    </div>

    <!-- ══ 战斗界面 ══ -->
    <div id="battle-screen" class="hidden">
      <div id="battle-title">⚔️ BATTLE!</div>

      <div class="battle-combatants">
        <div class="combatant-card" id="battle-hero-card">
          <h3>🧙 英雄</h3>
          <div class="combatant-hp">
            <label>HP</label>
            <div class="hp-bar" style="flex:1">
              <div class="hp-bar-fill" id="battle-hero-hp-bar" style="width:62.5%"></div>
            </div>
            <span class="hp-text" id="battle-hero-hp-text">50 / 80</span>
          </div>
          <div class="combatant-shield">🛡 护盾: <span id="battle-hero-shield">0</span></div>
        </div>

        <div class="combatant-card" id="battle-monster-card">
          <h3 id="battle-monster-name">🟢 怪物</h3>
          <div class="combatant-hp">
            <label>HP</label>
            <div class="hp-bar" style="flex:1">
              <div class="hp-bar-fill" id="battle-monster-hp-bar"
                   style="width:100%;background:linear-gradient(90deg,#2e7d32,#4caf50)"></div>
            </div>
            <span class="hp-text" id="battle-monster-hp-text">25 / 25</span>
          </div>
          <div class="combatant-intent" id="battle-monster-intent">💭 …</div>
        </div>
      </div>

      <div class="battle-energy-row">
        <label>能量</label>
        <div id="energy-display"></div>
        <span id="energy-text" style="font-size:0.8rem;color:var(--text-dim)">3 / 3</span>
        <button id="end-turn-btn">结束回合</button>
      </div>

      <div class="battle-hand-label">手牌</div>
      <div id="battle-hand"></div>
      <div id="battle-log"></div>
    </div>

  </div><!-- /game-container -->

  <!-- ══ 暂停菜单 ══ -->
  <div id="pause-menu" class="hidden">
    <div id="pause-box">
      <button class="pause-close-btn" id="pause-close">✕</button>
      <h2>⏸ 暂停</h2>

      <div class="pause-section">
        <h3>💾 保存存档</h3>
        <div class="pause-slots">
          <div class="pause-save-slot" data-slot="0">
            <span class="slot-label">存档 1</span>
            <span class="slot-info">（空）</span>
          </div>
          <div class="pause-save-slot" data-slot="1">
            <span class="slot-label">存档 2</span>
            <span class="slot-info">（空）</span>
          </div>
          <div class="pause-save-slot" data-slot="2">
            <span class="slot-label">存档 3</span>
            <span class="slot-info">（空）</span>
          </div>
        </div>
      </div>

      <div class="pause-actions">
        <button class="pause-btn" id="pause-resume">继续游戏</button>
        <button class="pause-btn danger" id="pause-back-menu">🏠 返回主菜单</button>
      </div>
    </div>
  </div>

  <!-- ══ 通用弹窗 ══ -->
  <div id="overlay" class="hidden">
    <div id="overlay-box">
      <div id="overlay-title"></div>
      <div id="overlay-msg"></div>
      <button id="overlay-btn"></button>
    </div>
  </div>

  <!-- ══ Toast 提示 ══ -->
  <div id="toast" class="hidden"></div>

  <script type="module" src="js/main.js"></script>
</body>
</html>
